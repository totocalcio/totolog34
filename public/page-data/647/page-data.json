{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-slug-tsx","path":"/647/","result":{"data":{"markdownRemark":{"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 596px; \n                margin-inline: 0;\n              \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b859ba9995bf3f78c1a2d6518e352459/699b7/image-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 103.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACn0lEQVQ4y52U6bKbOBCF/RwXkGQWAUIr4K2cpDJT83fe/3G+FGA7jpN7k8qPU13aTp9WL7sQNdMxEL1HN4ay7hBFQVEU5De7QAjxsB9hZ0OF9xNd+IQOZ3Q8owdPU1fYtqGqNVLJ1clHRHdnOxca+t5Sh4nGR1SpKAqxEsjlopCb2vw77qrX9UsEG+HgMM4Q0hesnzHzGTudGEJiTD0pDUyjYxztihgHYlj2Ld7WVOWLws54guvw00jVR5q2XcMNnWZoFfv9EpZESvHA8lhKiVLb+oXQYceeY7KMfcega8wNB9vjO03fVHT1Bl2VnLwhmW6FaWqUUk+Eg8eYhiJfPG+e5A1KyoeiZ7yqfWTZhZqhN2tYz5/7t9gZ1zAnT9PUZFm+kS6H4vc1t+HHe7u6KZGlpir3VKVCKUkulroTiCxH5MXqKHvLeHvLyLJsW2f5VkJC3BrhRmiCoXIHDtcr589nTilh3Ql/+ko6/0MfDjjXE5Nlmh0hDnjfE4Kh62pEkW+kN6U760tsOOIu/2IO15UgnL7gTp/ppyNl8ugpoOdIN3raONFoTVXtKUv1pO5O6Cp8ujD/9z/xeGW6XNF9QFWaIt/+dFGQF69d8v3sh5Ctr7BhpIszVd1QKkGRZeTZ2y1B24Otl5/sPRE/KQw1Png6F+l8pPUL+YE+zUi1f3fCvLe/G3xNMIHrZeR4dJg407oR4+zaWmtodxT5b8fZWtjGRLTxqM4iTGRf61WhtR3zZAlxok0HtI207fDhXNymjTGc/YUYJ8ynIzpZ6jESouEwefrxQmkTlT/QmrD+1z0JvyQcjGFOjhgSPkT2Ml9DXZCtNqN4IH8k4Zch29DQdi1K3rwW4l3vz+32vkKr12wuNbZeFPfyuJfCn/b0RvgNtI1RK+xQIycAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/b859ba9995bf3f78c1a2d6518e352459/699b7/image-5.png\"\n        srcset=\"/static/b859ba9995bf3f78c1a2d6518e352459/8a4e8/image-5.png 150w,\n/static/b859ba9995bf3f78c1a2d6518e352459/5a46d/image-5.png 300w,\n/static/b859ba9995bf3f78c1a2d6518e352459/699b7/image-5.png 596w\"\n        sizes=\"(max-width: 596px) 100vw, 596px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>公式ドキュメントを参考にしたはずだけど、初回起動時の Permission で拒否したらずっと alert が出るようになってしまうし、その上拒否したにも関わらず強行突破でカメラロールにアクセスできてしまう。</p>\n<p><a href=\"https://docs.expo.io/versions/latest/sdk/imagepicker/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.expo.io/versions/latest/sdk/imagepicker/</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \n                margin-inline: 0;\n              \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d902cf9b57c37f798c4d89087f4a4c80/242e2/image-6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABvklEQVQ4y52T627UMBSE9zma2LGT+BZf4mTLFrpU1Urw/o/0oWRLb0AR/BgdybI+zcyxD8Og6I1BmYlxKphYGPyEGR3GBEyqDD5hncX5EecN/p2sd3SdQgjBwVhFTpH104llXajLSi4zZTmSUiKFgA8RawxGK/zYM+iOthW0bfusDSal5GCcZoqB4ias7tCyRUmB2mbb0EuBlgIptinpu45Oih24AV5rd7hF1s6hbXiJO1icnbBlxaQZExwpe2IKhGCZpmv8n5DX0IN1ilQr9fyd5eEb6XSm3D0S6y1mXTDHFVMTrhZ8SgyDZtxiD/oDYElMyx02FfphQEhF29zQ3twg2uZNVy/diWfYa+h1KbczrtyS5oqfV/x8xJcFpXuk7H7p6n1vbxxuSyklc//1zP3lgXq+MH+5UD4/4lKibZqr22Zz2/7W1Tug2p9HjjNDzHQhYXMlzpl1mUjziqsn/HLChkTfj3+EPXWoiTlQ/EKej9i1MOaAS4Fapr0KHTJjXNC6p+u6j4Fb5Jw9JU6UPOOsQ4pmL73Zym+afTG7hPh7ZOt7QnTPl4WQu/5lEW+AWivU0z+8Hopd4j9gG/AHuqJu7wwXTAIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/d902cf9b57c37f798c4d89087f4a4c80/0a47e/image-6.png\"\n        srcset=\"/static/d902cf9b57c37f798c4d89087f4a4c80/8a4e8/image-6.png 150w,\n/static/d902cf9b57c37f798c4d89087f4a4c80/5a46d/image-6.png 300w,\n/static/d902cf9b57c37f798c4d89087f4a4c80/0a47e/image-6.png 600w,\n/static/d902cf9b57c37f798c4d89087f4a4c80/242e2/image-6.png 703w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>公式に ImagePicker の別のページがあったのでそっちのコードを参考にしてみた。</p>\n<p><a href=\"https://docs.expo.io/tutorial/image-picker/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.expo.io/tutorial/image-picker/</a></p>\n<p>「写真を選ぶ」を押すと Alert が表示され、カメラロールへのアクセスを拒否してくれるが、一度拒否したらアプリ上から許可の設定を行う導線が消えてしまうので不親切。\nAlert の場合再度 Permission の処理を行いたいが、Alert は処理を待ってくれないので工夫しなければならない。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \n                margin-inline: 0;\n              \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8d30bb87b3721b8029faa97a14b8c7ee/1f083/image-7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrklEQVQ4y5WU63LcIAxG9zlqDAhzNRgnm9skmb7/Y52O7XS7bTqT7I9vhLB8kEaCUymGeW3IupLOnd4LOXvEObQVtB4ZtWYcR7TWX+pUiqX1RquVt3UmemEY1A7YtQV+E/YXsORKdII1hnE8Ph52vPjfAuZiWXojL4XYF7yPxMmg9HgFuzHDA5h5el55f3/kvCRaTkxiUTeU+ynDlASxGjEGMVuAuTTjxqZUcl6YQkJ8xIjDyIS5An6/5NnS10qKmSlVYu07VHxGjD26fAswBEMqmclZjFaMajiy+hiZzVfbnlKoL7T9d0rJEmpjPd/z/PpE7vfE5ZE4JbLL+FgIc2MKkRg9OXlyCZQSd6XNz56YAsbKkWFIAT+vhHpH6mdCXQl5Zi4LqfZ9z5dGzuEAlHBZ74fk8Ae4dXntjYe7Nx5ennj5+cbz6z3zujCVhohgJGBcQKlxv0XDD7VbNRylDsNVyWUWWitMXoh1kyMtDp8MMmms2+yxlsnuvouC8xZjzf+7XJeZJXViCGijMWL2YCsfcna3256xxyE7zHyez5P32+lyXLHfD8IN+nfofwG0B6H9gyCpywAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/8d30bb87b3721b8029faa97a14b8c7ee/0a47e/image-7.png\"\n        srcset=\"/static/8d30bb87b3721b8029faa97a14b8c7ee/8a4e8/image-7.png 150w,\n/static/8d30bb87b3721b8029faa97a14b8c7ee/5a46d/image-7.png 300w,\n/static/8d30bb87b3721b8029faa97a14b8c7ee/0a47e/image-7.png 600w,\n/static/8d30bb87b3721b8029faa97a14b8c7ee/1f083/image-7.png 660w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>そこで ReactNative の Alert を利用する。</p>\n<p><a href=\"https://reactnative.dev/docs/alert\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://reactnative.dev/docs/alert</a></p>\n<p>本当は再度許可するかどうかのウィンドウを出したかったのだけど、うまくいかなかったので直接設定画面をひらくようにする。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 414px; \n                margin-inline: 0;\n              \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9228013bdaa5abbd4c4da89cef6deb94/b910a/image-8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACL0lEQVQ4y5WU627bOBhE8xYLV6JEkeKdulp27STF7o8Cff8nOgvRdZpuHbT7g6AgiAcz34z45F1DnhPdcMUPI5eXI6fnlfNlZciBkEfc8oJ1A8mOSONohKBpmofrybuWYdHY4Yg+nug+r/jnjfV0Zp4TMVpc8AhlqVWPaCVVXVMLUfZ9CSHe1ndgTwwZezrS58A6Z7ZjJLoW0ymy64lGs0SH7xVGdxjV4XtNMJq2bQrsh8J1Bw6YGLmOkX+2ieuYWFPg2/XIdUrl3Zd1ZPQW1+sC3GHB9KiuK7A3heN6UxjyUg6cx8gcfTmwq9KdxBuNbBuklIimod5t1+LN8i/AEAbSOGOc46/DgcPhUD4+VFU5+Km6zU18EIj4RaEf8GMiLZ4wb9g4YLQqynrVMThDrxRt234IfZvhHRjGTBgV+frK/PoV3VuWYDjnwBJcsXu39ofARJoTqrdIpWnatsxNS3lT9g72EfQBMNO0XZlb2zQoKZGy/a2yBynfLMepZ7w8M24nou35+5jZcsAbU/pW1aKEU9/3d6V+OMMduJ0XXr5cWM8nxlGTs2VaMsl3qFaWGu09NN3tWbbygcLvwDTtavekz6TTK8P2mdM2cLnMzDmzBs8cDJO3bNGx7r+msmilqUX9H+CUCJMlJU0jKuqqQoi6lLiqbvvd5t3ye7tCND8X2+WJlFIJ5XcBPArk3W1jiD6Sc0ZLVaTf2/9/oU/e7peDJecZp2Wx8ScV+ajY/wJHFOM+DOvAIwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/9228013bdaa5abbd4c4da89cef6deb94/b910a/image-8.png\"\n        srcset=\"/static/9228013bdaa5abbd4c4da89cef6deb94/8a4e8/image-8.png 150w,\n/static/9228013bdaa5abbd4c4da89cef6deb94/5a46d/image-8.png 300w,\n/static/9228013bdaa5abbd4c4da89cef6deb94/b910a/image-8.png 414w\"\n        sizes=\"(max-width: 414px) 100vw, 414px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>これで一応、無許可でカメラロールにアクセスすることも回避できて、許可していなかった場合に設定できる導線も確保できた。\nと、思ったらやはり Android だと設定画面にいかないので処理を分ける必要がある。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \n                margin-inline: 0;\n              \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ac199b97f6b9b3d268fabe704447755d/fcda8/image-9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACGklEQVQ4y52U6W7bMBCE8xyxLt43ZdnKUbh9/8f6CjFx4Bx20v4YCFhxBzPc5dylrNBxIdWZZT2wrDPGeWSYCTqgdUBOir7vGYbhW9yVWZJTxi9H4umELgesDxhjiFqhjGccR4YLwlvkd7kKUi7INCMOCbf3pOCwVjM2ZYK+H+j6nq7r2/dM+hVxI8yl4I4L+VA5PS0sc2GJjmMOPJREMBotBdFqjJI/UFgqMRsekuG5JmZveaqROVhqsCgpGMcBMY2IaaLfmq+Q3pUqiLlQloB3it39rh2+tNh/QLN85S5fFRZCDeScKQ+/MSFQnG5KjVbtDi+b+huDeRtKnAMpBmysCG0wYsIp2Sb8VfOPCHOKTNIwjSNeS5SY3k30k+2rlvNm2VNKYn1+Zr8U9rUSfEAq/X8Kw+zJORHrQnn8RTquHNfKsvdUpyjOsARLtBIlx+8J0+xJm+VJ0nVdm3R/A1ctn9cmzRFnpk8TvYabCstGGFMj67uvD/bDD8PhvIf7kLDeIvXYmjfbLyp+RvTOckoZmSpyzYSH1MLBOYMUimGQL+Hw+mrOuN917LoXXL6mt7fs1pXyuPDntPJ43BOsJjrLkgLBKKySLRiMFG0/t/DIzlC8bf/Gj2kTUkRPA0YI1DS1JqsEaUsYKVrabLUNcppa3RvVsNWmLTTeFOaMN+adpTPOli7Rv9Y/Wm4K99VgrWO32/3T5V9bpb8XijAcdXNP3wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/ac199b97f6b9b3d268fabe704447755d/fcda8/image-9.png\"\n        srcset=\"/static/ac199b97f6b9b3d268fabe704447755d/8a4e8/image-9.png 150w,\n/static/ac199b97f6b9b3d268fabe704447755d/5a46d/image-9.png 300w,\n/static/ac199b97f6b9b3d268fabe704447755d/fcda8/image-9.png 590w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Android は許可していなかったら毎回許可するかのウィンドウがでるので、\nメッセージのみの表示にした。\nひとまずこれで目的は達成できた。</p>","frontmatter":{"date":"2020-11-19","slug":"/647","title":"ImagePickerでカメラロールのPermissionがgranted：falseなのにアクセスできてしまう","tags":["reactnative","expo"],"thumbnail":null},"excerpt":"公式ドキュメントを参考にしたはずだけど、初回起動時の Permission で拒否したらずっと alert が出るようになってしまうし、その上拒否したにも関わらず強行突破でカメラロールにアクセスできてしまう。 https://docs…","tableOfContents":""},"site":{"siteMetadata":{"title":"うさ技術"}}},"pageContext":{"id":"02234551-5c1d-5e48-b49c-ad594a09c753","frontmatter__slug":"/647","__params":{"frontmatter__slug":"647"}}},"staticQueryHashes":["1304567263","209911134","3832698534"]}