{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-slug-tsx","path":"/647/","result":{"data":{"markdownRemark":{"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 596px; \n                margin-inline: 0;\n              \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b859ba9995bf3f78c1a2d6518e352459/699b7/image-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 103.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACoElEQVR42p2U2ZKkNhRE6zfcIEGxaZdA1OruWWIe7P//ouMQvVRPL+OxHzIQQqQypbx3p1VLXi3rcSZYTz9a9t1AXVfUQmwQGyRSPo6llJ9ip01LSBofr6h0z5jO6HRmmBRm7LHTRNsPvyR5Rtlsp02DDwZlI/18YrAa0TTIouRJjRANdS0+h7gp35lCGC3GWVzKzPMDJq34wxW3nAjRk7NlWTxrLmPPkj0pGZbFMc8WZ9qbwmdCawPLbNDzkV45lJpIeiLoET1JmqageYXbXNu+tRwt2jnywXKMbiNy04AeemajWJ3Gq3F7L5j6bvt+SY5kJharGLr9Rr4pdMFivGcauu1Mtp2lfFHRFkUfXEKZb5/UvrrlolCj1YSU9Yv0/4ud0iU2ljV5hHy8TVkyVxb8RlTe5XAcGvb9wL4b6fYNfdcipKCWDbKqEQW1oKoqqruKu7vqcVzVG8RLtJ5jo1umtGCWE5evX7hcV1a/Ypc/ydcfhOMXjI/EEpOnyITkiNEQoqXvmp+qZ2dMiwuKcPyKv35HLyd8vhIv3wjnB6ac6ZeIOs6oQ0LnmSnMDMOefui2yLwndIr88Df521/k8z3peKGbPO2+Q9T1dpZ1wUtty6cq+cByqWUfFT6fGUv5dR2trKnv/qCuqtviV3jbIH5SqHVDnA0+JFRcUNvzgFmOTC582l0+m3+07DXHlLm/X5hzwswndExoozZbm7VniPc237SvEmyDsZnBWBq70EyG0QZsmklRs+aIm4+MMaNdou+GjfhzhUET3MwlXLGnFXstNxswS2TNlryuDMuFzs1MpVcO078TpuA4zIm0HHBGIepqC/TNcvXK9i8sl+Zgo2Ecuq1CpGi2WIjf6M4fK9QtRitq8dQU5CNuP4n/VMv/ABA/Uf5nM3c+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/b859ba9995bf3f78c1a2d6518e352459/699b7/image-5.png\"\n        srcset=\"/static/b859ba9995bf3f78c1a2d6518e352459/8a4e8/image-5.png 150w,\n/static/b859ba9995bf3f78c1a2d6518e352459/5a46d/image-5.png 300w,\n/static/b859ba9995bf3f78c1a2d6518e352459/699b7/image-5.png 596w\"\n        sizes=\"(max-width: 596px) 100vw, 596px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>公式ドキュメントを参考にしたはずだけど、初回起動時の Permission で拒否したらずっと alert が出るようになってしまうし、その上拒否したにも関わらず強行突破でカメラロールにアクセスできてしまう。</p>\n<p><a href=\"https://docs.expo.io/versions/latest/sdk/imagepicker/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.expo.io/versions/latest/sdk/imagepicker/</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \n                margin-inline: 0;\n              \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d902cf9b57c37f798c4d89087f4a4c80/242e2/image-6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5ElEQVR42oWS7W6bMBhGcxstGNvYGBvbGBJKtmXLvrRfu//rOVNIlTWtuv04MkLo8Ph5313nWro0Mi0L87ri5xUXZ6Id8C7ip4VuyIShJ2fPOIYbKfntnR8CjZQIIdgZq+hcRxdH+lQIecINCZ8KfRjoQ8L0A8YYWq0wWqGVRMq/KKVomuYq7INmKoX1sDDlgTQEBh9IwyVhR3Qd3jmcNXjbEjuDNQohroKXXKQ761pMZ9FCIuqK6vHxRn2hup5VVW3UtaCq65vgJVtC22nsEOnSRJgXXCoMIRNjITx9wO+fCGOk7EemeSSla5c+2JvkpXTnvGLcLyzffzOff5GPn0nLl63PNkfaMdHmARsjxvUoJdFabecmE81bYd4X+ryn8x6lFaKR1HVF/fCAqKqNertu/aYz0Yi7lDvnNXk/UdYT6/lMOf2gnH5SPn3D+rDJN0HT3ImuiG04rxJqSsoc15myTPTjgVAO+HGm9w4pBFKqbc+kUsjnH7weyE3Ye03MiRj2mPGAKiP9sjAthdPHmXI849cz8fgVFxKtNv8WOt+Sc2DJM4dlZSgRZRWq1Zi2RbYWoTRSG5qX3b0j3fWhJWWPMRpjLEoqxHP5l527PF9F9d2+vZ/QtdjO3k3wvY//J7sI/wBCEnCfNqXd+wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/d902cf9b57c37f798c4d89087f4a4c80/0a47e/image-6.png\"\n        srcset=\"/static/d902cf9b57c37f798c4d89087f4a4c80/8a4e8/image-6.png 150w,\n/static/d902cf9b57c37f798c4d89087f4a4c80/5a46d/image-6.png 300w,\n/static/d902cf9b57c37f798c4d89087f4a4c80/0a47e/image-6.png 600w,\n/static/d902cf9b57c37f798c4d89087f4a4c80/242e2/image-6.png 703w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>公式に ImagePicker の別のページがあったのでそっちのコードを参考にしてみた。</p>\n<p><a href=\"https://docs.expo.io/tutorial/image-picker/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.expo.io/tutorial/image-picker/</a></p>\n<p>「写真を選ぶ」を押すと Alert が表示され、カメラロールへのアクセスを拒否してくれるが、一度拒否したらアプリ上から許可の設定を行う導線が消えてしまうので不親切。\nAlert の場合再度 Permission の処理を行いたいが、Alert は処理を待ってくれないので工夫しなければならない。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \n                margin-inline: 0;\n              \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8d30bb87b3721b8029faa97a14b8c7ee/1f083/image-7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrElEQVR42p2Ty5LbIBBF/RsZCdGIhwAB0thWZSr5/+86KckZx5Ns7CxONSy4ffvBKSVhWs6E7cryc+N6XVjOCz4WRhtQw8CgFMMen+CUZ2GumVBn1j16g1I9Sqm72B7Vk6I3wVYoMXOODmsM/cNjpV51mIXSCjFnjHMMg0YPA32v7q7UqyUfgjVy/bHx8f3Ce3F4ZzHymtiDYCW1SC2eUiIxOJJziJb/EHws2Wjevr3R9T1d330p+YWhGEqdSbExlZXYzowhMfqM0eZ1hzEJpSSMCJ3SaBHUoFBa353d1+gJTiEYfJ6pbWZdZ2yI2KngzL5CHi0GMeORSERjjHxB5Ba16JvDaRJczuT1QrtupHUjtAvBRYqfie1Cet8Ie9IaaTtLZl0yraVjiEtL5JKPxKcpCikGprQSciUv76R5xueKzZXRWsRGxIZj4buuv9Pv9Dc+e31Ks6HVQs2N5VK4fKyct8yUPWItWuuj7J1B/26+Hv6cHzh6eEy5ZErOxOKxcW/BiJ2E0QvGCTaY43zcreDiyOj3JP8u/ilGIaQJJx4ZBLV/uU+emOrfX/MXQ4OiwRtEUIEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/8d30bb87b3721b8029faa97a14b8c7ee/0a47e/image-7.png\"\n        srcset=\"/static/8d30bb87b3721b8029faa97a14b8c7ee/8a4e8/image-7.png 150w,\n/static/8d30bb87b3721b8029faa97a14b8c7ee/5a46d/image-7.png 300w,\n/static/8d30bb87b3721b8029faa97a14b8c7ee/0a47e/image-7.png 600w,\n/static/8d30bb87b3721b8029faa97a14b8c7ee/1f083/image-7.png 660w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>そこで ReactNative の Alert を利用する。</p>\n<p><a href=\"https://reactnative.dev/docs/alert\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://reactnative.dev/docs/alert</a></p>\n<p>本当は再度許可するかどうかのウィンドウを出したかったのだけど、うまくいかなかったので直接設定画面をひらくようにする。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 414px; \n                margin-inline: 0;\n              \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9228013bdaa5abbd4c4da89cef6deb94/b910a/image-8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACIklEQVR42pWU2W7bMBBF+xdNbVIbtXATtcbykiBB0f//pVOIzuLEToo+DCQRmDN37iX0w+oE2wVyv8eGlsNpYjkMLPsBaxtq11H1B3TtcVUgVTWJlCRJcrN+WJPhh4oq7FDjRHmY0MeZcd7R9w7vNY1zJKohVQ0yzRBCIKQ8P4VASvlWEdj2FdYGqmVGecM0Be5nh6lTVJ6jy4JGFbi6pCxyVJ7FqlRBpfKoTL6oPgOHCmsCtbXsW8vj2DKvYGf4swwce8/z3PE0dQRdoysVB/imwtUVRf4OvQC2GN8x2YaHMTB6E5vvW0NV5LE5z1LyLEfKBCEkWyFiyRf/roA+9BRlyc+7OzabDZut4Nd2G31a38WLT1dhXJy/A3XAdAY3WJq2R9WaWuXUqoi+2bqMfl769bk+KoxAhwmKcHqmO/5GqZLR1sxOM9iGLMu+Bd5QaLGdjerWStKMMs+i0tW/1btX2FfQG8AWIRK22w1J8t4sv/Lv+5VXYE27O2K6Id67p6ll8gZdlbHpNRhxMeRtmEyuPbRdyXKceXhc6Meevs0wpiYEQ12mpElKlqYU8Qqd39ezFSaTG6G4rsRqi5+PtPsnut3CsgucTiOD98xW05uK0TbsnI6h6aKhyIvbK5uuxLviwrP0vKKQHwKJK3/noTEB3bZY70jT/EPzmu5l0+v3lYeXfxtnHM63qKxASPFtmv9IOcWPDd61NGWG+DT9f6F/Aa5r42ue3y+0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/9228013bdaa5abbd4c4da89cef6deb94/b910a/image-8.png\"\n        srcset=\"/static/9228013bdaa5abbd4c4da89cef6deb94/8a4e8/image-8.png 150w,\n/static/9228013bdaa5abbd4c4da89cef6deb94/5a46d/image-8.png 300w,\n/static/9228013bdaa5abbd4c4da89cef6deb94/b910a/image-8.png 414w\"\n        sizes=\"(max-width: 414px) 100vw, 414px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>これで一応、無許可でカメラロールにアクセスすることも回避できて、許可していなかった場合に設定できる導線も確保できた。\nと、思ったらやはり Android だと設定画面にいかないので処理を分ける必要がある。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \n                margin-inline: 0;\n              \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ac199b97f6b9b3d268fabe704447755d/fcda8/image-9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACI0lEQVR42pVUWVLcMBTkHFj7Zu22xhgIleL+t+qUNTAxkxlwPrqkUkmt12/ph5QNTGzI84y2LmhPM+wYoMKEaAOMjZBcgVIKxtiPeCiTRk4Zvi2Ib7+gc4MbA6wxCEZD2RGMcbAd4XfkD6VKpFyh8gR5SgjNI0cP5wy40GBMgtIzCaH0QkZ3+ytC1QnHZUZtBb9fGlrNOCWPpxLxXBOCNbBKIjkDq9WBCEtFyhZrsngpCdVbPJfY1zxaKCnBGYPkHELwHjG7Q9ojjLmiNI/RaQyPQ79MdhKvwRgFvZPLi+RQPXIuqC/vcCFgGi2m4G5KpN8U5oOwIE4BKQYYnyC0hpG8541xfvPxMcIUIbWDFALBbqTiS0W/yv5J8uRRSsL6+op2qphrRQgBypie060onzgQYUWcthwmxNqQ11ek04JlKZi3j0aNMlq04BCtglb8Z8lp8l0y5xJkGEAJ6SDkr0xyTLLsbZOmAGfEuccOzOzdCPMkUXJFDglkGzFy4+J2zg6aQ57OkucQ4YKDMrw/JpvkjyY+QrRzG4WYSjcHtRak59zNwXsLKQ0YU5f87fE4EAzkjL1pXGZ5fFpQ1xnvbwvW0wRvNdLocEqhm4PT6gKjZDeP4l2fpu2M74uSS0VIEZozGCGgBIcSok9Kb3AlYaSEkqJDCt4/GY3q2M7OpkHPOYwpYzT6H0PY9p+Sro1i+GipfVv1COdqYYztF/4n+fda6Q9B+TAco6LwRQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/ac199b97f6b9b3d268fabe704447755d/fcda8/image-9.png\"\n        srcset=\"/static/ac199b97f6b9b3d268fabe704447755d/8a4e8/image-9.png 150w,\n/static/ac199b97f6b9b3d268fabe704447755d/5a46d/image-9.png 300w,\n/static/ac199b97f6b9b3d268fabe704447755d/fcda8/image-9.png 590w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Android は許可していなかったら毎回許可するかのウィンドウがでるので、\nメッセージのみの表示にした。\nひとまずこれで目的は達成できた。</p>","frontmatter":{"date":"2020-11-19","slug":"/647","title":"ImagePickerでカメラロールのPermissionがgranted：falseなのにアクセスできてしまう","tags":["reactnative","expo"],"thumbnail":null},"excerpt":"公式ドキュメントを参考にしたはずだけど、初回起動時の Permission で拒否したらずっと alert が出るようになってしまうし、その上拒否したにも関わらず強行突破でカメラロールにアクセスできてしまう。 https://docs…","tableOfContents":""},"site":{"siteMetadata":{"title":"うさ技術"}}},"pageContext":{"id":"02234551-5c1d-5e48-b49c-ad594a09c753","frontmatter__slug":"/647","__params":{"frontmatter__slug":"647"}}},"staticQueryHashes":["1753915958","209911134","3832698534"],"slicesMap":{}}