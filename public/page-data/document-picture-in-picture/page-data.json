{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-slug-tsx","path":"/document-picture-in-picture/","result":{"data":{"markdownRemark":{"html":"<h2 id=\"document-picture-in-picture-apiについて\" style=\"position:relative;\"><a href=\"#document-picture-in-picture-api%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\" aria-label=\"document picture in picture apiについて permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Document Picture-in-Picture APIについて</h2>\n<p>最新バージョンのChrome116で<code class=\"language-text\">Document Picture-in-Picture API</code>が実装されました。</p>\n<p><code class=\"language-text\">Picture-in-Picture API</code>自体はすでに実装されていたのですが、使用できるのは<code class=\"language-text\">video</code>要素のみでした。\n今回のアップデートにより、<code class=\"language-text\">video</code>要素に限らず、ウェブページ上の任意の要素を<code class=\"language-text\">Picture-in-Picture</code>モードで表示できるようになりました。</p>\n<h2 id=\"作成したwebアプリ\" style=\"position:relative;\"><a href=\"#%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9Fweb%E3%82%A2%E3%83%97%E3%83%AA\" aria-label=\"作成したwebアプリ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>作成したWebアプリ</h2>\n<p><code class=\"language-text\">Document Picture-in-Picture API</code>の機能を使って、簡単なWebアプリを作成しました。\nテキストエリアに入力した内容を<code class=\"language-text\">Picture in Picture</code>モードで表示します。\nそれ以外の機能としては、文字色と文字の大きさを簡単に変えられるようになっていることと、<code class=\"language-text\">1/319</code>の確率で<strong>宇宙一かわいいうさぎの画像が表示</strong>されます。（強制的に表示させる隠しコマンドもある。）</p>\n<p><a href=\"https://memo-in.vercel.app/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MEMO IN</a></p>\n<h2 id=\"コードの紹介\" style=\"position:relative;\"><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E7%B4%B9%E4%BB%8B\" aria-label=\"コードの紹介 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コードの紹介</h2>\n<p>今回<code class=\"language-text\">Nuxt</code>でつくったので<code class=\"language-text\">Vue.js</code>のコードで紹介します。</p>\n<p>JavaScriptのコードは<a href=\"https://developer.chrome.com/docs/web-platform/document-picture-in-picture/#examples\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">参考サイト</a>を参照してください。</p>\n<h3 id=\"ウインドウを表示する\" style=\"position:relative;\"><a href=\"#%E3%82%A6%E3%82%A4%E3%83%B3%E3%83%89%E3%82%A6%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\" aria-label=\"ウインドウを表示する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ウインドウを表示する</h3>\n<p><code class=\"language-text\">requestWindow()</code>にはオプションとして<code class=\"language-text\">width</code>と<code class=\"language-text\">height</code>を渡しています。</p>\n<div class=\"gatsby-highlight\" data-language=\"vue\"><pre class=\"language-vue\"><code class=\"language-vue\">&lt;script lang=&quot;ts&quot; setup&gt;\n...\nconst inputVal = ref&lt;string&gt;(&#39;&#39;)\nconst pipContainer = ref&lt;HTMLElement | null&gt;(null)\nconst pipBody = ref&lt;HTMLElement | null&gt;(null)\nconst pipWindow = ref&lt;WindowWithPictureInPicture | null&gt;(null)\nconst isPip = ref&lt;boolean&gt;(false)\nconst onOpen = async () =&gt; {\n  isPip.value = true\n  const option = {\n    width: 300,\n    height: 300,\n  }\n  // Picture-in-Picture ウィンドウを開く.\n  pipWindow.value = await window.documentPictureInPicture.requestWindow(option)\n  // 入力されたテキストを Picture-in-Picture ウィンドウに挿入する.\n  pipWindow.value.document.body.append(pipBody.value)\n}\n&lt;/script&gt;\n&lt;template&gt;\n  &lt;main&gt;\n    &lt;textarea v-model=&quot;inputVal&quot; &gt;&lt;/textarea&gt;\n    &lt;div ref=&quot;pipContainer&quot;&gt;\n      &lt;div ref=&quot;pipBody&quot;&gt;{{ inputVal }}&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;button v-if=&quot;!isPip&quot; type=&quot;button&quot; @click=&quot;onOpen&quot; aria-pressed=&quot;false&quot;&gt;開く&lt;/button&gt;\n    &lt;button v-else type=&quot;button&quot; @click=&quot;onClose&quot; aria-pressed=&quot;true&quot;&gt;閉じる&lt;/button&gt;\n  &lt;/main&gt;\n&lt;/template&gt;</code></pre></div>\n<h3 id=\"ウインドウを閉じる\" style=\"position:relative;\"><a href=\"#%E3%82%A6%E3%82%A4%E3%83%B3%E3%83%89%E3%82%A6%E3%82%92%E9%96%89%E3%81%98%E3%82%8B\" aria-label=\"ウインドウを閉じる permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ウインドウを閉じる</h3>\n<div class=\"gatsby-highlight\" data-language=\"vue\"><pre class=\"language-vue\"><code class=\"language-vue\">&lt;script lang=&quot;ts&quot; setup&gt;\nconst onClose = async () =&gt; {\n  isPip.value = false\n  // Picture-in-Picture ウィンドウを閉じる.\n  pipWindow.value?.close()\n}\n&lt;/script&gt;</code></pre></div>\n<h3 id=\"ウインドウを閉じた時のイベント\" style=\"position:relative;\"><a href=\"#%E3%82%A6%E3%82%A4%E3%83%B3%E3%83%89%E3%82%A6%E3%82%92%E9%96%89%E3%81%98%E3%81%9F%E6%99%82%E3%81%AE%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88\" aria-label=\"ウインドウを閉じた時のイベント permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ウインドウを閉じた時のイベント</h3>\n<div class=\"gatsby-highlight\" data-language=\"vue\"><pre class=\"language-vue\"><code class=\"language-vue\">&lt;script lang=&quot;ts&quot; setup&gt;\nconst onOpen = async () =&gt; {\n  ...\n  pipWindow.value.addEventListener(&#39;pagehide&#39;, (event: Event) =&gt; {\n    pipContainer.value?.append(pipBody.value as string | Node)\n    isPip.value = false\n  })\n}\n&lt;/script&gt;</code></pre></div>\n<h3 id=\"demo\" style=\"position:relative;\"><a href=\"#demo\" aria-label=\"demo permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Demo</h3>\n<p>ここまでのコードをまとめたものは下記を参考にしてください。</p>\n<ul>\n<li><a href=\"https://codesandbox.io/p/sandbox/wizardly-wildflower-nrhln8?file=/src/components/DocumentPip.vue:1,1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandBox(ソースコード)</a></li>\n<li><a href=\"https://nrhln8-5173.csb.app/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandBox(demo)</a></li>\n</ul>\n<h3 id=\"注意点\" style=\"position:relative;\"><a href=\"#%E6%B3%A8%E6%84%8F%E7%82%B9\" aria-label=\"注意点 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>注意点</h3>\n<p><code class=\"language-text\">Picture in Picture</code>ウィンドウは元ウィンドウからCSSが引き継がれません。そのため<code class=\"language-text\">JavaScript</code>で<code class=\"language-text\">CSS</code>をコピーする必要があります。</p>\n<ul>\n<li><a href=\"https://developer.chrome.com/docs/web-platform/document-picture-in-picture/#copy-style-sheets-to-the-picture-in-picture-window\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">参考</a></li>\n</ul>\n<p>以前はオプションで<code class=\"language-text\">copyStyleSheets</code>を指定するのみでよかったのですが、議論の末に削除されたという経緯があります。</p>\n<ul>\n<li><a href=\"https://github.com/WICG/document-picture-in-picture/pull/79\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Remove copyStyleSheets</a></li>\n</ul>\n<h2 id=\"実現できていないこと課題\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E7%8F%BE%E3%81%A7%E3%81%8D%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E3%81%93%E3%81%A8%E8%AA%B2%E9%A1%8C\" aria-label=\"実現できていないこと課題 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実現できていないこと・課題</h2>\n<ul>\n<li>ウィンドウが300 ✕ 300 より小さくはならない</li>\n<li>Picture in Pictureのキーボード操作を理解していない。</li>\n</ul>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Chrome116で実装された<code class=\"language-text\">Document Picture-in-Picture API</code>について紹介しました。<br>\n現在はChrome,Edgeのみしか使用できませんが、helpやtipsなどの表示であったり、今回作成したWebアプリのように、常にデスクトップの見える位置に配置するといった使い方で、利用価値のある場面もあるのかなと思いました。</p>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://developer.chrome.com/blog/new-in-chrome-116/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">New in Chrome 116</a></li>\n<li><a href=\"https://developer.chrome.com/docs/web-platform/document-picture-in-picture/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Picture-in-Picture for any Element, not just &#x3C;video></a></li>\n</ul>","frontmatter":{"date":"2023-09-10","slug":"/document-picture-in-picture","title":"Document Picture-in-Picture APIで簡単なWebアプリを作成","tags":["Vue"],"thumbnail":{"publicURL":"/static/ff5fbc2b3f1ba2bd84be59e0d6cf58cd/pip.png"}},"excerpt":"Document Picture-in-Picture APIについて 最新バージョンのChrome11…","tableOfContents":"<ul>\n<li>\n<p><a href=\"#document-picture-in-picture-api%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\">Document Picture-in-Picture APIについて</a></p>\n</li>\n<li>\n<p><a href=\"#%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9Fweb%E3%82%A2%E3%83%97%E3%83%AA\">作成したWebアプリ</a></p>\n</li>\n<li>\n<p><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E7%B4%B9%E4%BB%8B\">コードの紹介</a></p>\n<ul>\n<li><a href=\"#%E3%82%A6%E3%82%A4%E3%83%B3%E3%83%89%E3%82%A6%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\">ウインドウを表示する</a></li>\n<li><a href=\"#%E3%82%A6%E3%82%A4%E3%83%B3%E3%83%89%E3%82%A6%E3%82%92%E9%96%89%E3%81%98%E3%82%8B\">ウインドウを閉じる</a></li>\n<li><a href=\"#%E3%82%A6%E3%82%A4%E3%83%B3%E3%83%89%E3%82%A6%E3%82%92%E9%96%89%E3%81%98%E3%81%9F%E6%99%82%E3%81%AE%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88\">ウインドウを閉じた時のイベント</a></li>\n<li><a href=\"#demo\">Demo</a></li>\n<li><a href=\"#%E6%B3%A8%E6%84%8F%E7%82%B9\">注意点</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E5%AE%9F%E7%8F%BE%E3%81%A7%E3%81%8D%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E3%81%93%E3%81%A8%E8%AA%B2%E9%A1%8C\">実現できていないこと・課題</a></p>\n</li>\n<li>\n<p><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%8F%82%E8%80%83\">参考</a></p>\n</li>\n</ul>"},"site":{"siteMetadata":{"title":"うさ技術"}}},"pageContext":{"id":"8337cff0-67cd-5c50-b8fc-113f554a0e4e","frontmatter__slug":"/document-picture-in-picture","__params":{"frontmatter__slug":"document-picture-in-picture"}}},"staticQueryHashes":["1753915958","209911134","3832698534"],"slicesMap":{}}